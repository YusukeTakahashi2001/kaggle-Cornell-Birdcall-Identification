[2020-09-04 00:41:49,906][__main__] line25 [INFO] logger start
[2020-09-04 00:41:49,906][__main__] line26 [INFO] git hash is: 2aa9aaa
[2020-09-04 00:41:49,911][__main__] line27 [INFO] all params
======================================================================
globals:
  debug: 0
  seed: 1213
  device: cuda
  num_epochs: 35
  folds:
  - 0
data:
  train_df_path: data_ignore/external_dataset/32khz/birdsong-resampled-train-audio-01/train_mod.csv
  train_audio_path: data_ignore/external_dataset/32khz
  test_df_path: ./data/external_dataset/birdcall-check/test_audio
  test_audio_path: ./data/external_dataset/birdcall-check/test.csv
split:
  name: StratifiedKFold
  params:
    n_splits: 5
    random_state: 42
    shuffle: true
dataset:
  name: SpectrogramDataset
  img_size: 224
  params:
    n_mels: 128
    fmin: 20
    fmax: 16000
loader:
  train:
    batch_size: 20
    shuffle: true
    num_workers: 2
  valid:
    batch_size: 10
    shuffle: false
    num_workers: 2
model:
  name: ResNet50
  params:
    base_model: resnet50
    pretrained: true
    n_classes: 264
loss:
  name: ResNetLoss
  params:
    loss_type: bce
optimizer:
  name: Adam
  params:
    lr: 0.001
scheduler:
  name: CosineAnnealingLR
  params:
    T_max: 10

======================================================================
[2020-09-04 00:41:50,130][__main__] line47 [INFO] ====================
[2020-09-04 00:41:50,131][__main__] line48 [INFO] Fold 0
[2020-09-04 00:41:50,131][__main__] line49 [INFO] ====================
[2020-09-04 00:41:52,841][__main__] line74 [INFO] ::: epoch: 1/35 Fri Sep  4 00:41:52 2020 :::
[2020-09-04 00:55:42,052][__main__] line80 [INFO] loss_train: 0.029719, loss_valid: 0.025627, f1(macro): 0.000052
[2020-09-04 00:55:42,142][__main__] line74 [INFO] ::: epoch: 2/35 Fri Sep  4 00:55:42 2020 :::
[2020-09-04 01:09:27,071][__main__] line80 [INFO] loss_train: 0.025531, loss_valid: 0.025123, f1(macro): 0.000094
[2020-09-04 01:09:27,319][__main__] line74 [INFO] ::: epoch: 3/35 Fri Sep  4 01:09:27 2020 :::
[2020-09-04 01:23:11,860][__main__] line80 [INFO] loss_train: 0.025186, loss_valid: 0.027534, f1(macro): 0.000511
[2020-09-04 01:23:11,861][__main__] line74 [INFO] ::: epoch: 4/35 Fri Sep  4 01:23:11 2020 :::
[2020-09-04 01:37:02,192][__main__] line80 [INFO] loss_train: 0.024816, loss_valid: 0.057737, f1(macro): 0.000475
[2020-09-04 01:37:02,193][__main__] line74 [INFO] ::: epoch: 5/35 Fri Sep  4 01:37:02 2020 :::
[2020-09-04 01:50:55,422][__main__] line80 [INFO] loss_train: 0.024434, loss_valid: 0.024888, f1(macro): 0.000803
[2020-09-04 01:50:55,593][__main__] line74 [INFO] ::: epoch: 6/35 Fri Sep  4 01:50:55 2020 :::
[2020-09-04 02:04:51,500][__main__] line80 [INFO] loss_train: 0.023742, loss_valid: 0.023337, f1(macro): 0.005394
[2020-09-04 02:04:51,701][__main__] line74 [INFO] ::: epoch: 7/35 Fri Sep  4 02:04:51 2020 :::
[2020-09-04 02:18:37,325][__main__] line80 [INFO] loss_train: 0.022701, loss_valid: 0.035831, f1(macro): 0.008287
[2020-09-04 02:18:37,326][__main__] line74 [INFO] ::: epoch: 8/35 Fri Sep  4 02:18:37 2020 :::
[2020-09-04 02:32:20,648][__main__] line80 [INFO] loss_train: 0.021532, loss_valid: 0.021653, f1(macro): 0.029304
[2020-09-04 02:32:20,882][__main__] line74 [INFO] ::: epoch: 9/35 Fri Sep  4 02:32:20 2020 :::
[2020-09-04 02:46:11,250][__main__] line80 [INFO] loss_train: 0.020608, loss_valid: 0.020529, f1(macro): 0.048642
[2020-09-04 02:46:11,471][__main__] line74 [INFO] ::: epoch: 10/35 Fri Sep  4 02:46:11 2020 :::
[2020-09-04 02:59:50,248][__main__] line80 [INFO] loss_train: 0.020098, loss_valid: 0.019952, f1(macro): 0.064672
[2020-09-04 02:59:50,481][__main__] line74 [INFO] ::: epoch: 11/35 Fri Sep  4 02:59:50 2020 :::
[2020-09-04 03:13:33,662][__main__] line80 [INFO] loss_train: 0.019921, loss_valid: 0.019902, f1(macro): 0.063746
[2020-09-04 03:13:33,952][__main__] line74 [INFO] ::: epoch: 12/35 Fri Sep  4 03:13:33 2020 :::
[2020-09-04 03:27:23,943][__main__] line80 [INFO] loss_train: 0.019829, loss_valid: 0.019694, f1(macro): 0.070218
[2020-09-04 03:27:24,134][__main__] line74 [INFO] ::: epoch: 13/35 Fri Sep  4 03:27:24 2020 :::
[2020-09-04 03:41:09,035][__main__] line80 [INFO] loss_train: 0.019855, loss_valid: 0.020043, f1(macro): 0.073047
[2020-09-04 03:41:09,038][__main__] line74 [INFO] ::: epoch: 14/35 Fri Sep  4 03:41:09 2020 :::
[2020-09-04 03:55:04,976][__main__] line80 [INFO] loss_train: 0.019719, loss_valid: 0.019188, f1(macro): 0.092036
[2020-09-04 03:55:05,202][__main__] line74 [INFO] ::: epoch: 15/35 Fri Sep  4 03:55:05 2020 :::
[2020-09-04 04:08:51,336][__main__] line80 [INFO] loss_train: 0.019406, loss_valid: 0.027728, f1(macro): 0.088191
[2020-09-04 04:08:51,337][__main__] line74 [INFO] ::: epoch: 16/35 Fri Sep  4 04:08:51 2020 :::
[2020-09-04 04:22:35,494][__main__] line80 [INFO] loss_train: 0.018864, loss_valid: 0.018648, f1(macro): 0.137828
[2020-09-04 04:22:35,730][__main__] line74 [INFO] ::: epoch: 17/35 Fri Sep  4 04:22:35 2020 :::
[2020-09-04 04:36:19,919][__main__] line80 [INFO] loss_train: 0.018250, loss_valid: 0.018615, f1(macro): 0.145967
[2020-09-04 04:36:20,141][__main__] line74 [INFO] ::: epoch: 18/35 Fri Sep  4 04:36:20 2020 :::
[2020-09-04 04:50:00,403][__main__] line80 [INFO] loss_train: 0.017752, loss_valid: 0.017039, f1(macro): 0.196727
[2020-09-04 04:50:00,626][__main__] line74 [INFO] ::: epoch: 19/35 Fri Sep  4 04:50:00 2020 :::
[2020-09-04 05:03:50,016][__main__] line80 [INFO] loss_train: 0.017141, loss_valid: 0.016558, f1(macro): 0.216242
[2020-09-04 05:03:50,244][__main__] line74 [INFO] ::: epoch: 20/35 Fri Sep  4 05:03:50 2020 :::
[2020-09-04 05:17:34,868][__main__] line80 [INFO] loss_train: 0.016455, loss_valid: 0.020359, f1(macro): 0.128270
[2020-09-04 05:17:34,870][__main__] line74 [INFO] ::: epoch: 21/35 Fri Sep  4 05:17:34 2020 :::
[2020-09-04 05:31:25,097][__main__] line80 [INFO] loss_train: 0.015812, loss_valid: 0.017590, f1(macro): 0.215826
[2020-09-04 05:31:25,099][__main__] line74 [INFO] ::: epoch: 22/35 Fri Sep  4 05:31:25 2020 :::
[2020-09-04 05:45:09,538][__main__] line80 [INFO] loss_train: 0.015233, loss_valid: 0.015316, f1(macro): 0.292044
[2020-09-04 05:45:09,759][__main__] line74 [INFO] ::: epoch: 23/35 Fri Sep  4 05:45:09 2020 :::
[2020-09-04 05:58:52,712][__main__] line80 [INFO] loss_train: 0.014443, loss_valid: 0.018597, f1(macro): 0.177366
[2020-09-04 05:58:52,713][__main__] line74 [INFO] ::: epoch: 24/35 Fri Sep  4 05:58:52 2020 :::
[2020-09-04 06:12:40,440][__main__] line80 [INFO] loss_train: 0.013685, loss_valid: 0.014761, f1(macro): 0.327182
[2020-09-04 06:12:40,671][__main__] line74 [INFO] ::: epoch: 25/35 Fri Sep  4 06:12:40 2020 :::
[2020-09-04 06:26:31,624][__main__] line80 [INFO] loss_train: 0.012928, loss_valid: 0.013537, f1(macro): 0.383687
[2020-09-04 06:26:31,842][__main__] line74 [INFO] ::: epoch: 26/35 Fri Sep  4 06:26:31 2020 :::
[2020-09-04 06:40:11,433][__main__] line80 [INFO] loss_train: 0.012259, loss_valid: 0.013361, f1(macro): 0.391243
[2020-09-04 06:40:11,671][__main__] line74 [INFO] ::: epoch: 27/35 Fri Sep  4 06:40:11 2020 :::
[2020-09-04 06:54:00,959][__main__] line80 [INFO] loss_train: 0.011470, loss_valid: 0.013240, f1(macro): 0.417869
[2020-09-04 06:54:01,185][__main__] line74 [INFO] ::: epoch: 28/35 Fri Sep  4 06:54:01 2020 :::
[2020-09-04 07:07:45,911][__main__] line80 [INFO] loss_train: 0.010892, loss_valid: 0.012383, f1(macro): 0.445224
[2020-09-04 07:07:46,121][__main__] line74 [INFO] ::: epoch: 29/35 Fri Sep  4 07:07:46 2020 :::
[2020-09-04 07:21:30,566][__main__] line80 [INFO] loss_train: 0.010467, loss_valid: 0.011861, f1(macro): 0.473436
[2020-09-04 07:21:30,796][__main__] line74 [INFO] ::: epoch: 30/35 Fri Sep  4 07:21:30 2020 :::
[2020-09-04 07:35:17,123][__main__] line80 [INFO] loss_train: 0.010179, loss_valid: 0.011801, f1(macro): 0.474560
[2020-09-04 07:35:17,347][__main__] line74 [INFO] ::: epoch: 31/35 Fri Sep  4 07:35:17 2020 :::
[2020-09-04 07:49:02,753][__main__] line80 [INFO] loss_train: 0.010056, loss_valid: 0.011777, f1(macro): 0.477686
[2020-09-04 07:49:02,996][__main__] line74 [INFO] ::: epoch: 32/35 Fri Sep  4 07:49:02 2020 :::
[2020-09-04 08:02:42,756][__main__] line80 [INFO] loss_train: 0.010028, loss_valid: 0.011760, f1(macro): 0.476575
[2020-09-04 08:02:42,950][__main__] line74 [INFO] ::: epoch: 33/35 Fri Sep  4 08:02:42 2020 :::
[2020-09-04 08:16:30,640][__main__] line80 [INFO] loss_train: 0.010256, loss_valid: 0.011762, f1(macro): 0.479503
[2020-09-04 08:16:30,641][__main__] line74 [INFO] ::: epoch: 34/35 Fri Sep  4 08:16:30 2020 :::
[2020-09-04 08:30:30,504][__main__] line80 [INFO] loss_train: 0.010398, loss_valid: 0.012071, f1(macro): 0.470034
[2020-09-04 08:30:30,506][__main__] line74 [INFO] ::: epoch: 35/35 Fri Sep  4 08:30:30 2020 :::
[2020-09-04 08:44:12,712][__main__] line80 [INFO] loss_train: 0.010556, loss_valid: 0.012646, f1(macro): 0.442285
[2020-09-04 08:44:12,870][__main__] line106 [INFO] best_loss: 0.011760, best_fscore(macro): 0.476575
[2020-09-04 08:44:12,873][__main__] line107 [INFO] ::: success :::
